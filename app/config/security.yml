# To get started with security, check out the documentation:
# http://symfony.com/doc/current/book/security.html
security:

    encoders:
        Symfony\Component\Security\Core\User\User: sha1
        Vendor\ConnectUsersBundle\Entity\UsersWeb:
            algorithm: sha512
            iterations: 6666
            encode_as_base64: true
        Vendor\ConnectUsersBundle\Entity\UsersEmployee:
            algorithm: sha512
            iterations: 6666
            encode_as_base64: true
        
    role_hierarchy:
            ROLE_USER: [ROLE_USER]
            ROLE_LIVREUR: [ROLE_LIVREUR]
            ROLE_ADMIN: [ROLE_ADMIN]
            ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]
    providers:
        core:
            entity:
                    class:    Vendor\ConnectUsersBundle\Entity\UsersWeb
                    property: email
        admin:
            entity:
                    class:    Vendor\ConnectUsersBundle\Entity\UsersEmployee
                    property: email
    firewalls:
        dev:
            pattern: ^/(_(profiler|wdt)|css|images|js)/
            security: false
        login:
            pattern: ^/compte/connexionweb$
            security: false   
        core:
            host: ^www\.mealandbox\.fr$
            pattern: ^/
            anonymous: true
            provider:  core
            form_login:
               login_path: /compte/connexionweb
               check_path: /compte/login_check
               default_target_path: /
               failure_path: /
            logout:
                path:   /compte/deconnexion
                target: /
            remember_me:
                secret:   '%secret%'
                lifetime: 604800 # 1 week in seconds
                path:     /
                httponly: true
        
        admin:
            host: ^admin\.mealandbox\.fr$
            pattern: ^/
            anonymous: true
            http_basic:
                provider:  admin
            form_login:
               login_path: /compte/connexionadmin
               check_path: /compte/login_check
               default_target_path: /
               failure_path: /
            logout:
                path:   /compte/deconnexion
                target: /
    access_control:
               - { path: ^/, roles: IS_AUTHENTICATED_ANONYMOUSLY, host: ^admin\.mealandbox\.fr$  }            
               - { path: ^/*, roles: ROLE_ADMIN, host: ^admin\.mealandbox\.fr$ }
            # activate different ways to authenticate

            # http_basic: ~
            # http://symfony.com/doc/current/book/security.html#a-configuring-how-your-users-will-authenticate

            # form_login: ~
            # http://symfony.com/doc/current/cookbook/security/form_login_setup.html
